# =============================================================================
# GDBFuzz SSD Firmware Fuzzing Configuration
# =============================================================================
# 이 파일을 SSD 환경에 맞게 수정하세요.

[SUT]
# -----------------------------------------------------------------------------
# 펌웨어 바이너리 경로 (Ghidra에서 분석한 것과 동일해야 함)
# -----------------------------------------------------------------------------
binary_file_path = /path/to/your/ssd_firmware.bin

# -----------------------------------------------------------------------------
# Entrypoint: 퍼징할 함수의 시작 주소
# - 동적 분석으로 찾은 NVMe 커맨드 핸들러 주소
# - 예: 0x00012345 또는 함수명 (심볼이 있는 경우)
# -----------------------------------------------------------------------------
entrypoint = 0x00000000

# -----------------------------------------------------------------------------
# 브레이크포인트 설정
# -----------------------------------------------------------------------------
# 브레이크포인트 hit 없이 이 횟수만큼 입력 실행 후 브레이크포인트 재배치
until_rotate_breakpoints = 100

# 동시에 설정할 최대 하드웨어 브레이크포인트 수
# ARM Cortex-R8은 보통 6~8개 지원, 안전하게 4개 사용
max_breakpoints = 4

# 무시할 함수 목록 (공백으로 구분)
# 예: ignore_functions = malloc free memcpy
ignore_functions =

# -----------------------------------------------------------------------------
# 타겟 모드
# -----------------------------------------------------------------------------
# Hardware: 외부 GDB 서버 (J-Link) 사용
# QEMU: QEMU 에뮬레이션 사용
# SUTRunsOnHost: 호스트에서 직접 실행
target_mode = Hardware

# Ghidra 자동 시작 여부 (False면 수동으로 Ghidra Bridge 실행해야 함)
start_ghidra = False

# -----------------------------------------------------------------------------
# 에러 감지용 소프트웨어 브레이크포인트 (선택)
# - 에러 핸들러 함수 주소를 넣으면 크래시로 감지
# - 예: software_breakpoint_addresses = 0xDEAD 0xBEEF
# -----------------------------------------------------------------------------
software_breakpoint_addresses =

# 소프트웨어 브레이크포인트 hit을 에러로 간주할지
consider_sw_breakpoint_as_error = True


[SUTConnection]
# -----------------------------------------------------------------------------
# NVMe Connection 설정
# -----------------------------------------------------------------------------
SUT_connection_file = NVMeConnection.py

# NVMe 장치 경로
device = /dev/nvme0

# NVMe Admin Command Opcode
# 0x06 = Identify
# 0x02 = Get Log Page
# 0x09 = Set Features
# 0xC0~0xFF = Vendor Specific
opcode = 0xC0

# Namespace ID (보통 1)
namespace = 1

# 타임아웃 (밀리초)
timeout = 5000


[GDB]
# -----------------------------------------------------------------------------
# GDB 설정
# -----------------------------------------------------------------------------
path_to_gdb = gdb-multiarch

# J-Link GDB Server 주소
# JLinkGDBServer 기본 포트: 2331
gdb_server_address = localhost:2331


[Fuzzer]
# -----------------------------------------------------------------------------
# Fuzzer 설정
# -----------------------------------------------------------------------------
# 최대 입력 길이 (바이트)
maximum_input_length = 4096

# 단일 실행 타임아웃 (초)
single_run_timeout = 10

# 총 퍼징 시간 (초)
# 3600 = 1시간, 86400 = 24시간
total_runtime = 3600

# 시드 디렉토리 (선택)
# 초기 입력 파일들이 있는 폴더
# 비워두면 랜덤 입력으로 시작
seeds_directory =


[BreakpointStrategy]
# -----------------------------------------------------------------------------
# 브레이크포인트 전략
# -----------------------------------------------------------------------------
# RandomBasicBlockStrategy.py: 랜덤하게 도달 안 한 블록 선택 (기본)
# RandomBasicBlockNoDomStrategy.py: dominance 관계 미사용
# RandomBasicBlockNoCorpusStrategy.py: corpus 미사용 (블랙박스처럼)
# BlackboxStrategy.py: 브레이크포인트 없음 (커버리지 측정만)
breakpoint_strategy_file = RandomBasicBlockStrategy.py


[Dependencies]
# -----------------------------------------------------------------------------
# 의존성 경로
# -----------------------------------------------------------------------------
path_to_qemu = ./dependencies/qemu/build/x86_64-linux-user/qemu-x86_64
path_to_ghidra = ./dependencies/ghidra/


[LogsAndVisualizations]
# -----------------------------------------------------------------------------
# 로그 및 출력 설정
# -----------------------------------------------------------------------------
# 로그 레벨: DEBUG, INFO, WARNING, ERROR, CRITICAL
loglevel = INFO

# 출력 디렉토리
output_directory = ./output/ssd_fuzz/

# Web UI 사용 여부 (mosquitto MQTT 필요)
enable_UI = False
